#!/bin/bash

export PROJECT_NAME="agileavatars"
export SRC="./src"
export DATA="./data"
export MODULES="$SRC/modules"
export TESTS="./tests"
export TEST_HELPERS="./test-helpers"
export TEST_WATCH_PATTERN="{$SRC,$TESTS,$TEST_HELPERS}/**/*.js"
export ESLINT_PATHS=("$SRC" "$TESTS" "$TEST_HELPERS")
export INDEXGEN_PATHS="$DATA $MODULES/** $TEST_HELPERS/**"
export INDEXGEN_TYPE="esm"
export GITHUB_PAGES_PATH="./docs"
export COV_BRANCHES=100
export COV_LINES=100
export COV_FUNCTIONS=100
export COV_STATEMENTS=100

[ -f ./task-vars ] && . ./task-vars

function task() {
    echo "$1 started"
    "tasks/$1" "${@:2}"
    EXIT_CODE=$?
    echo
    echo "exit code $EXIT_CODE"
}

time task $@
echo
exit $EXIT_CODE
